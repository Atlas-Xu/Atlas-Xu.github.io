---
title: HCIP-RS学习笔记（In Updating）
tags:
  - 网络
abbrlink: 74d1c79b
description: >-
  本笔记仅为考试后的总结整理，包含了视频学习和刷题中的问题理解，部分内容倾向于考试本身，如有疏漏和错误烦请指出。由于暂时懒得搭建gitbook，于是把所有内容都整到一篇内了....
date: 2024-06-19 00:54:00
---

# 交换部分
## Vlan

## QinQ


# 路由部分


# 网络安全技术
## 端口隔离
### 隔离类型
- **双向隔离**：同一端口隔离组的接口之间互相隔离，不同端口隔离组的接口之间不隔离。端口隔离只是针对同一设备上的端口隔离组成员，对于不同设备上的接口而言，无法实现该功能。
- **单向隔离**：实现不同端口隔离组的接口之间的隔离。缺省情况下，未配置端口单向隔离。
### 隔离模式
- **L2（二层隔离三层互通）**：隔离同一VLAN内的广播报文，但是不同端口下的用户还可以进行三层通信。缺省情况下，端口隔离模式为二层隔离三层互通。
- **ALL（二层三层都隔离）**：同一VLAN的不同端口下用户二三层彻底隔离无法通信。

## MAC地址安全
### MAC地址表项类型
- **动态MAC地址表项**：由接口通过报文中的源MAC地址学习获得表项可老化。在系统复位、接口板热插拔或接口板复位后，动态表项会丢失。
- **静态MAC地址表项**：由用户手工配置并下发到各接口板，表项不老化。在系统复位、接口板热插拔或接口板复位后，保存的表项不会丢失。接口和MAC地址静态绑定后，其他接口收到源MAC是该MAC地址的报文将会被丢弃
- **黑洞MAC地址表项**：由用户手工配置，并下发到各接口板，表项不可老化。配置黑洞MAC地址后，源MAC地址或目的MAC地址是该MAC的报文将会被丢弃。
### MAC地址表安全功能
- **静态MAC地址表项**：将一些固定的上行设备或者信任用户的MAC地址配置为静态MAC表项可以保证其安全通信。
- **黑洞MAC地址表项**：防止黑客通过MAC地址攻击网络，交换机对来自黑洞MAC或者去往黑洞MAC的报文采取丢弃处理。
- 动态MAC地址老化时间：合理配置动态MAC地址表项的老化时间，可以防止MAC地址爆炸式增长。默认老化时间是300S
- **禁止MAC地址学习功能**：对于网络环境固定的场景或者已经明确转发路径的场景，通过配置禁止MAC地址学习功能，可以限制非信任用户接入，防止MAC地址攻击提高网络安全性。
- **限制MAC地址学习数量**：在安全性较差的网路环境中，通过限制MAC地址学习数量，可以防止攻击者通过变换MAC地址进行攻击。
## 端口安全
能够防止MAC地址欺骗攻击和MAC地址泛洪攻击
### 安全MAC地址
安全动态MAC地址的老化类型分为:绝对时间老化和相对时间老化：
- 如设置绝对老化时间为5分钟:系统隔1分钟计算一次每个MAC的存在时间，若大于等于5分钟，则立即将该安全动态MAC地址老化。否则，等待下1分钟再检测计算。
- 如设置相对老化时间为5分钟:系统每隔1分钟检测一次是否有该MAC的流量，若没有流量，则经过5分钟后将该安全动态MAC地址老化。
- 华为交换机AC地址表中动态Sticky MAC地址的默认老化时间是不会老化

| 类型           | 定义                                | 特点                                                               |
| ------------ | --------------------------------- | ---------------------------------------------------------------- |
| 安全动态MAC地址    | 使能端口安全而未使能Sticky MAC功能时转换的MAC地址   | 设备重启后表项会丢失，需要重新学习。缺省情况下不会被老化，只有在配置安全MAC的老化时间后才可以被老化。             |
| 安全静态MAC地址    | 使能端口安全时手工配置的静态MAC地址。              | 不会被老化，手动保存配置后重启设备不会丢失。                                           |
| Sticky MAC地址 | 使能端口安全又同时使能Sticky MAC功能时转换到的MAC地址 | 不会被老化，手动保存配置后重启设备不会丢失。<br><br>开启了sticky MAC功能之后，缺省接口学习的mac地址数量为1 |
### 安全保护动作
- **Restrict**：丢弃源MAC地址不存在的报文并上报告警，合法的正常通信，非法的产生日志。
- **Protect**：只丢弃源MAC地址不存在的报文，不上报告警。
- **Shutdown**：接口状态被置为error-down，并上报告警。
## MAC地址漂移
如果是环路引发MAC地址漂移，治本的方法是部署防环技术，例如STP，消除二层环路。如果由于网络攻击等其他原因引起，则可使用如下MAC地址防漂移特性：
- **配置接口MAC地址学习优先级**：当MAC地址在交换机的两个接口之间发生漂移时，可以将其中一个接口的MAC地址学习优先级提高。高优先级的接口学习到的MAC地址表项将覆盖低优先级接口学习到的MAC地址表项。
- **配置不允许相同优先级接口MAC地址漂移**：当伪造网络设备所连接口的MAC地址优先级与安全的网络设备相同时后学习到的伪造网络设备MAC地址表项不会覆盖之前正确的表项。在配置不允许相同优先级接口MAC地址漂移时如果安全则交换机仍会学习到伪造网络设备的MAC地址，当网络设备下电再次上电时将无法学习到正确的MAC地址：如果交换机的接口连接的网络设备是服务器，当服务器下电后，因比该特性需谨值傅用另外的接口学习到与服务器相同的MAC地址习到正确的MAC地址
### MAC地址漂移检测
交换机支持MAC地址漂移检测机制，分为以下两种方式：
- 基于VLAN的MAC地址漂移检测
	- 配置VLAN的MAC地址漂移检测功能可以检测指定VLAN下的所有的MAC地址是否发生漂移
	- 当MAC地址发生漂移后，可以配置指定的动作，例如告警、阻断接口或阻断MAC地址（无法阻断VLAN和进行流量过滤）。

- 全局MAC地址漂移检测
	- 该功能可以检测设备上的所有的MAC地址是否发生了漂移。
	- 若发生漂移，设备会上报告警到网管系统。
	- 用户也可以指定发生漂移后的处理动作，例如将接口关闭（error-down）或退出VLAN。
	- 如果接口由于发生了MAC地址漂移从而被设置为Error-Down，默认情况下是不会自动恢复的。
## MACsec
MACsec定义了基于以太网的数据安全通信的方法，通过逐跳设备之间数据加保证数据传输安全性，对应的标准为802.1AE。
可提供：用户数据加密、完整性检查、数据源真实性校验、重放保护
### 典型应用场景
- 在交换机之间部署MACsec保护数据安全，例如在接入交换机与上联的汇聚或核心交换机之间部署。
- 当交换机之间存在传输设备时可部署MACsec保护数据安全。
### 工作机制
在设备运行点到点MACsec时，网络管理员在两台设备上通过命令行预配置相同的CAK，两台设备会通过MKA协议选举出-个Key server，Key server决定加密方案，Key server会根据CAK等参数使用某种加密算法生成SAK数据密钥，由Key server将SAK分发给对端设备，这样两台设备拥有相同的SAK数据密钥，可以进行后续MACsec数据报文加解密收发。